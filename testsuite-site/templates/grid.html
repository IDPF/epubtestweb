{% extends 'base.html' %}
{% load assignments %}
{% load filters %}

{% block title %}: Reading System Evaluations
{% if is_archive_view %}
(Archives)
{% endif %}

{% endblock %}

{% block content %}

<h1>Reading System Evaluations {% if is_archive_view %}(Archives){% endif %}</h1>

{% if is_archive_view %}
<p>The following reading system evaluations have been archived but are still available to view. For the latest, please visit the <a href="/">home page</a>.</p>
{% else %}
<p>The following reading systems have been evaluated:</p>
{% endif %}

{% has_supercategories testsuite.categories as has_supercats %}
{% get_supercategories testsuite.categories as supercats %}

{% include '_table_view_links.html' %}
    <table id="rs" class="table table-striped">
        {% if has_supercats %}
        <col>
          {% if testsuite.testsuite_type == "2" %}
          {% comment %}accessibility grid takes an extra column for AT {% endcomment %}
          <colgroup span="3"></colgroup>
          {% else %}
          <colgroup span="2"></colgroup>
          {% endif %}

          {% for supercat in supercats %}
          <colgroup span="{{supercat.value}}"></colgroup>
          {% endfor %}
        </col>
        {% endif %}

        <thead>
          {% if has_supercats %}
          <tr class="table-header-row">
            {% if testsuite.testsuite_type == "2" %}
            {% comment %}accessibility grid takes an extra column for AT {% endcomment %}
            <th colspan="3" scope="colgroup">Reading System</th>
            {% else %}
            <th colspan="2" scope="colgroup">Reading System</th>
            {% endif %}

            {% for supercat in supercats %}
            <th colspan="{{supercat.value}}" scope="colgroup">{{supercat.name}}</th>
            {% endfor %}
          </tr>
          {% endif %}

          <tr>
              <th>#</th>
              <th>Name</th>

              {% if testsuite.testsuite_type == "2" %}
              <th class="none">AT</th>
              {% endif %}

              {% for category in testsuite.categories %}
              <th class="none">{{category.name}}</th>
              {% endfor %}
          </tr>
        </thead>
        <tbody>
            {% for evaluation in evaluations %}
            <tr>
                <td>{{forloop.counter}}</td>
                <td>
                    <a href="/evaluation/{{evaluation.id}}">{{evaluation.reading_system | get_reading_system_display_name}}</a>
                </td>
                {% if testsuite.testsuite_type == "2" %}
                    {% get_metadata evaluation as metadata %}
                    <td>{{metadata.assistive_technology}}</td>
                {% endif %}
                    {% for category in testsuite.categories %}
                        {% get_score evaluation category as category_score %}
                        <td>
                            <a href="/evaluation/{{evaluation.id}}#{{category.category_id}}">
                                {{category_score | score_as_percent}}
                            </a>
                        </td>
                    {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if is_archive_view == False %}
    <p><a href="archive/">View Archives</a></p>
    {% endif %}

    <script>
        var dt = new DT();

        $(document).ready(function(){
            setView('');
        });

        function setView(tblType) {
            dt.setTableType(tblType);
            var options = {
                    searchable: true,
                    setDefaultSort: true,
                    changeDefaultSort: true,
                    tableType: tblType
                }
            dt.initialize(options);
        }
    </script>

{% endblock %}
