{% extends 'base.html' %}
{% load assignments %}
{% load filters %}

{% block title %}: Reading System Evaluations
{% if is_archive_view %}
(Archives)
{% endif %}

{% endblock %}

{% block content %}

<h1>Reading System Evaluations {% if is_archive_view %}(Archives){% endif %}</h1>

{% if is_archive_view %}
<p>The following reading system evaluations have been archived but are still available to view. For the latest, please visit the <a href="/">home page</a>.</p>
{% else %}
<p>The following reading systems have been evaluated:</p>
{% endif %}

{% get_supercategories testsuite.categories as supercats %}

{% include '_table_view_links.html' %}
    <table id="rs" class="table table-striped table-bordered">
      {% if testsuite.testsuite_type == "2" %}
        <col>
          <colgroup span="3"></colgroup>

          {% for supercat in supercats %}
          <colgroup span="{{supercat.value}}"></colgroup>
          {% endfor %}
        </col>
      {% endif %}

        <thead>
          {% if testsuite.testsuite_type == "2" %}
          <tr class="table-header-row">
            <th colspan="3" scope="colgroup">Reading System</th>
            {% for supercat in supercats %}
            {% if supercat.name != None %}
              <th colspan="{{supercat.value}}" scope="colgroup">{{supercat.name}}</th>
            {% endif %}
            {% endfor %}
            <th colspan="2" scope="colgroup">Summaries</th>
          </tr>
          {% endif %}

          <tr class="table-header-row">
              <th scope="col">#</th>
              <th scope="col">Name</th>

              {% if testsuite.testsuite_type == "2" %}
              <th scope="col" class="none">AT</th>
              {% endif %}

              {% for category in testsuite.categories %}
              <th scope="col" class="none">{{category.name}}</th>
              {% endfor %}

              {% if testsuite.testsuite_type == "2" %}
              <th scope="col" class="none">Short Summary</th>
              <th scope="col" class="none">Long Summary</th>
              {% endif %}

          </tr>
        </thead>
        <tbody>
            {% for evaluation in evaluations %}
            <tr>
                <td>{{forloop.counter}}</td>
                <th scope="row">
                    <a href="/evaluation/{{evaluation.id}}">{{evaluation.reading_system | get_reading_system_display_name}}</a>
                </td>
                {% if testsuite.testsuite_type == "2" %}
                    {% get_metadata evaluation as metadata %}
                    <td>{{metadata.assistive_technology}}</td>
                {% endif %}
                    {% for category in testsuite.categories %}
                        {% get_score evaluation category as category_score %}
                        <td>
                            <a href="/evaluation/{{evaluation.id}}#{{category.category_id}}">
                                {{category_score | score_as_percent}}
                            </a>
                        </td>
                    {% endfor %}
                    {% if testsuite.testsuite_type == "2" %}
                    <td>{{evaluation.short_summary | dont_say_none}}</td>
                    <td><a href="/evaluation/{{evaluation.id}}#long_summary">Read more</a></td>
                    {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if is_archive_view == False %}
    <p><a href="archive/">View Archives</a></p>
    {% endif %}

    <script>
        var dt = new DT();

        $(document).ready(function(){
            setView('');
        });

        function setView(tblType) {
            dt.setTableType(tblType);
            var options = {
                    searchable: true,
                    setDefaultSort: true,
                    changeDefaultSort: true,
                    tableType: tblType
                }
            dt.initialize(options);
        }
    </script>

{% endblock %}
