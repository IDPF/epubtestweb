{% extends 'base.html' %}
{% load assignments %}
{% load filters %}

{% block content %}

<h1 id="top">{{evaluation.reading_system|get_reading_system_display_name}}

{% if evaluation.testsuite.testsuite_type == "2" %}
{% get_metadata evaluation as metadata %}
/ {{metadata.assistive_technology}}
{% endif %}

</h1>

<h2>Testsuite: {{evaluation.testsuite.name}}</h2>

<nav class="category-list">
    <p class="small">Click on a category to view the detailed support summary below.</p>
    <table class="category-summary">
        <thead>
            <tr>
                <th>Category</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody>
    {% for category in categories %}
        {% get_score evaluation category as category_score %}
            <tr>
                <td><a href="#{{category.category_id}}">{{category.name}}</a></td>
                <td>{{category_score.percent | floatformat}}%</td>
            </tr>
    {% endfor %}
        </tbody>
    </table>
</nav>


<dl>
    <dt>Name</dt>
    <dd>{{evaluation.reading_system.name}}</dd>
    <dt>Version</dt>
    <dd>{{evaluation.reading_system.version}}</dd>
    <dt>Operating System</dt>
    <dd>{{evaluation.reading_system.operating_system}}</dd>
    <dt>Operating System Version</dt>
    <dd>
    {% if evaluation.reading_system.operating_system_version != None %}
    {{evaluation.reading_system.operating_system_version}}
    {% endif %}
    </dd>

{% if evaluation.testsuite.testsuite_type == "2" %}
{% get_metadata evaluation as metadata %}

    <dt>Assistive technology</dt>
    <dd>{{ metadata.assistive_technology }}</dd>
    
    <dt>Assistive technology features</dt>
    <dd>{{metadata | get_AT_metadata_description}}</dd>

{% endif %}
</dl>

{% for category in categories %}

{% get_score evaluation category as category_score %}

<h2 id="{{category.category_id}}" class="rs-category">{{category.name}}</h2>

<table class="table table-condensed">
    <thead>
        <tr>
            <th class="feature-hd">Feature</th>
            <th class="test-hd">Test</th>
            <th class="result-hd">Result</th>
        </tr>
    </thead>
    <tfoot>
        <tr class="score">
            <th colspan="2">Cumulative Score</th>
            <td class="score">{{category_score.percent | floatformat}}%</td>
        </tr>
    </tfoot>
    <tbody>
{% for feature in category.features %}
{% get_score evaluation feature as feature_score %}
<tr class="feature">
    <td id="{{feature.feature_id}}" colspan="2"><h3>{{feature.name}}</h3></td>
    <td class="result">{{feature_score.fraction}}</td>
</tr>
    {% for test in feature.tests %}
    {% get_result test evaluation as test_result%}
<tr>
    <td/>
    <td id="{{test.test_id}}" class="test">{{test.name}}</td>
    {% if test_result.result == "1" %}
    <td class="supported">
    {% elif test_result.result == "2" %}
    <td class="unsupported">
    {% else %}
    <td>
    {% endif %}
    {{test_result | get_result_description}}
    </td>
</tr>
    {% endfor %}
{% endfor %}
    </tbody>
</table>

<p class="top"><a href="#top">Back to Top</a></p>
{% endfor %}

{% if testsuite.id == 2 %}
</div>
{% endif %}
{% endblock %}
