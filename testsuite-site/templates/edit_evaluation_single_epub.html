{% extends 'base.html' %}
{% load assignments %}
{% load filters %}
{% load inclusions %}

{% block title %}:: Edit Evaluation :: {{epub.title}}{% endblock %}
{% block content %}

<h1>Edit Evaluation Section</h1>

<p>This page contains all the tests in <em>{{epub.title}} (<a href="{{epub_downloads_url}}{{epub.filename}}" target="_blank">download</a>).</em></p>
<p>There are {{results | length}} tests. You are {{epub.percent_complete | floatformat:2}}% complete with this section.</p>

<div class="form">
<form action="{{action_url}}" method="post">{% csrf_token %}

<table id="eval" class="table table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Description</th>
            <th>Required</th>
            <th class="result">Result</th>
        </tr>
    </thead>
    <tbody>
        {% for result in results %}
        <tr>
            {% get_form_for_result result results_formset as result_form %}
            <td>{{ result.test.test_id }}</td>
            <td class="desc">{{ result.test.description }}</td>
            <td>
                {% if result.test.required == True %}
                    Required
                {% else %}
                    Optional
                {% endif %}
            </td>
            <td class="result">{{ result_form.as_p }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{{ results_formset.management_form }}

{% if next_url != '' %}
<input type="hidden" name="next_url" value="{{ next_url }}"/>
<input type="submit" name="save_continue" value="Save and continue to next section" />
{% endif %}
<input type="submit" name="save" value="Save and go back"/>
</form>
</div>

<script>
    $(document).ready(function(){
        var dataTable = new DT({
            fixedHeader: true,
            fixedColumn: false,
            serachable: true,
            setDefaultSort: false,
            changeDefaultSort: false,
        });
        
        dataTable.initTables();
    });
</script>

{% endblock %}
